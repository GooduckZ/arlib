"""
Old implementation (just for reference)
"""